---
title: "OOO_plots_Anxiety_CM"
author: "Brooke Sevchik"
date: "3/5/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
```


## FIRST PLOTS

```{r data manipulation, first plot overall}
threat_percent_ooo_df <- mistake_df %>%
  count(chosenThreatStatus) %>%
  mutate(total_observations = nrow(mistake_df)) %>%
  mutate(percentage_chosenThreatStatus = (n/total_observations)*100)
threat_percent_ooo_df
```

```{r data manipulation, first plot by subject}
threat_percent_subjects_df <- mistake_df %>%
  group_by(subject) %>% 
  count(chosenThreatStatus) %>%
  mutate(total_observations = nrow(mistake_df)) %>%
  mutate(percentage_chosenThreatStatus = (n/total_observations)*100)
threat_percent_subjects_df
```

#overall (across subjects)

```{r ooo_plot overall, echo=FALSE}
ggplot(data = threat_percent_ooo_df, mapping = aes(x = chosenThreatStatus, y = percentage_chosenThreatStatus)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(x = "Chosen Threat Status", y = "Percentage") +
  scale_x_discrete(labels = c("neutral", "threat")) 
```

#by subject

```{r ooo_plot by subject, echo=FALSE}
ggplot(data = threat_percent_subjects_df, mapping = aes(x = chosenThreatStatus, y = percentage_chosenThreatStatus, fill = chosenThreatStatus)) +
  geom_boxplot(alpha = 0.5) +
  geom_jitter(width=0.1)
```



##SECOND PLOT

```{r data manipulation, second plot}

subject_acc_ooo_df <- ooo_df %>%
  group_by(subject, chosenThreatStatus) %>%
  summarize(mean_acc = mean(acc))
subject_acc_ooo_df
```



```{r ooo_plot, second plot, echo=FALSE}
ggplot(subject_acc_ooo_df, aes(x = chosenThreatStatus, y = mean_acc, fill=chosenThreatStatus)) +
  geom_boxplot(alpha=0.5) +
  geom_jitter(width=0.1)
```

#PLOTS WITH STAI SCORES ADDED

```{r data manipulation, first plot by subject/STAI version}
ooo_anxiety_df
threat_percent_anxiety_df <- ooo_anxiety_df  %>%
  group_by(subject, anxiety_level) %>% 
  count(chosenThreatStatus) %>%
  mutate(total_observations = nrow(mistake_df)) %>%
  mutate(percentage_chosenThreatStatus = (n/total_observations)*100)
threat_percent_anxiety_df


#high anxiety data frame, ooo first plot
high_anxiety_threat_df <- threat_percent_anxiety_df %>%
  filter(anxiety_level == 'high trait anxiety')
high_anxiety_threat_df

#moderate anxiety data frame, ooo first plot
moderate_anxiety_threat_df <- threat_percent_anxiety_df %>%
  filter(anxiety_level == 'moderate trait anxiety')
moderate_anxiety_threat_df

#high anxiety data frame, ooo first plot
low_anxiety_threat_df <- threat_percent_anxiety_df %>%
  filter(anxiety_level == 'low trait anxiety')
low_anxiety_threat_df
```

```{r ooo_plot, first plot by subject w STAI included, echo=FALSE}

#high anxiety
ggplot(data = high_anxiety_threat_df, mapping = aes(x = chosenThreatStatus, y = percentage_chosenThreatStatus, fill = chosenThreatStatus)) +
  geom_boxplot(alpha = 0.5) +
  geom_jitter(width=0.1) +
  ggtitle("High Trait Anxiety")

#moderate anxiety
ggplot(data = moderate_anxiety_threat_df, mapping = aes(x = chosenThreatStatus, y = percentage_chosenThreatStatus, fill = chosenThreatStatus)) +
  geom_boxplot(alpha = 0.5) +
  geom_jitter(width=0.1) +
  ggtitle('Moderate Trait Anxiety')

#low anxiety
ggplot(data = low_anxiety_threat_df, mapping = aes(x = chosenThreatStatus, y = percentage_chosenThreatStatus, fill = chosenThreatStatus)) +
  geom_boxplot(alpha = 0.5) +
  geom_jitter(width=0.1) +
  ggtitle ('Low Trait Anxiety')
```




```{r data manipulation, second plot/STAI version}
STAI_subject_acc_ooo_df <- merge(ooo_df, df_pilot1_STAI_simple, by = "subject", all = TRUE)
STAI_subject_acc_ooo_df

STAI_subject_acc_ooo_df <- STAI_subject_acc_ooo_df %>%
  group_by(subject, chosenThreatStatus, anxiety_level) %>%
  summarize(mean_acc = mean(acc))
STAI_subject_acc_ooo_df

#high anxiety data frame, ooo
high_anxiety_ooo_df <- STAI_subject_acc_ooo_df %>%
  filter(anxiety_level == 'high trait anxiety')
high_anxiety_ooo_df

#moderate anxiety data frame, ooo
moderate_anxiety_ooo_df <- STAI_subject_acc_ooo_df %>%
  filter(anxiety_level == 'moderate trait anxiety')
moderate_anxiety_ooo_df

#low anxiety data frame, ooo
low_anxiety_ooo_df <- STAI_subject_acc_ooo_df %>%
  filter(anxiety_level == 'low trait anxiety')
low_anxiety_ooo_df

```

```{r ooo_plot, second plot/STAI version, echo=FALSE}
ggplot(high_anxiety_ooo_df, aes(x = chosenThreatStatus, y = mean_acc, fill=chosenThreatStatus)) +
  geom_boxplot(alpha=0.5) +
  geom_jitter(width=0.1) +
  ggtitle('High Trait Anxiety')

ggplot(moderate_anxiety_ooo_df, aes(x = chosenThreatStatus, y = mean_acc, fill=chosenThreatStatus)) +
  geom_boxplot(alpha=0.5) +
  geom_jitter(width=0.1) +
  ggtitle('Moderate Trait Anxiety')

ggplot(low_anxiety_ooo_df, aes(x = chosenThreatStatus, y = mean_acc, fill=chosenThreatStatus)) +
  geom_boxplot(alpha=0.5) +
  geom_jitter(width=0.1) +
  ggtitle('Low Trait Anxiety')
```





